name: Shai-Hulud 2.0 Scan
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  schedule:
    - cron: '0 3 * * *' # Daily scan at 3 AM UTC

jobs:
  hulud-scan:
    name: Scan for Shai-Hulud 2.0 Compromise
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Shai-Hulud 2.0 Detector
        uses: gensecaihq/Shai-Hulud-2.0-Detector@v1
        with:
          fail-on-critical: true
          scan-lockfiles: true
          scan-node-modules: false
          output-format: text